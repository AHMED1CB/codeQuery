{% extends "layouts/base.php.twig" %}

{# Will Replace With Question Title #}
{% block title %}
	CodeQuery - Show Question
{% endblock %}


{% block content %}
	<section
		class="max-w-6xl mx-auto py-10 px-4 grid grid-cols-1 md:grid-cols-[1fr_2fr] gap-10">

		<!-- Question Sidebar -->
		<aside class="bg-[var(--color-card-bg)] border border-[var(--color-border)]  rounded-xl shadow-md p-6 h-fit">
			<h1 class="text-2xl font-bold text-[var(--color-text)] mb-4 ">
				{{question.details.title}}
			</h1>
			<p class="text-[var(--color-text)] leading-relaxed mb-6">
				{{question.details.description}}
			</p>

			<!-- Tags -->
			<div class="flex flex-wrap gap-2 mb-6">

				{% for tag in question.tags %}
					<span class="px-3 py-1 rounded-lg text-sm bg-[var(--color-primary)] text-white">{{tag.name}}</span>
				{% endfor %}
			</div>

			<!-- Votes -->
			<div class="flex items-center gap-3 mb-6">
				<button  id="vup" class="w-10 h-10 flex items-center justify-center rounded-lg bg-[var(--color-bg)] border border-[var(--color-border)] hover:bg-[var(--color-primary)] hover:text-white text-[var(--color-primary)]">
					<i class="ph ph-arrow-fat-up{{question.details.user_vote == 'UP' ? '-fill' : ''}}"></i>
				</button>
				<span id="totalVotes" class="text-[var(--color-text)] font-semibold text-xl">{{question.details.total_votes}}</span>
				<button id="vdown" class="w-10 h-10 flex items-center justify-center rounded-lg bg-[var(--color-bg)] border border-[var(--color-border)] hover:bg-[var(--color-accent)] hover:text-white text-[var(--color-primary)]">
					<i class="ph ph-arrow-fat-down{{question.details.user_vote == 'DOWN' ? '-fill' : ''}}"></i>
				</button>
			</div>

			<!-- Author -->
			<div class="flex items-center gap-3">
				<img src="{{storage('images/' ~ question.details.avatar)}}" alt="User Avatar" class="w-12 h-12 rounded-full border border-[var(--color-border)]">
				<div>
					<p class="text-sm font-medium text-[var(--color-text)]">{{question.details.full_name}}</p>
					<p class="text-xs text-gray-500">asked
						{{question.details.creation_date}}</p>
				</div>
			</div>
		</aside>

		<!-- Answers Column -->
		<div class="flex flex-col h-[80vh]">
			<h2 class="text-xl font-semibold text-[var(--color-text)] mb-4">Answers</h2>

			<!-- Scrollable Answers -->
			<div class="flex-1 overflow-y-auto space-y-6 pr-2">

				{% for answer in question.answers %}

					<div class="bg-[var(--color-card-bg)] border border-[var(--color-border)] rounded-xl shadow-md p-6">
						<p class="text-[var(--color-text)] leading-relaxed mb-4">{{answer.answer}}</p>
						<div class="flex items-center gap-3">
							<img src="{{storage("images/" ~ answer.avatar)}}" alt="User Avatar" class="w-8 h-8 rounded-full border border-[var(--color-border)]">
							<p class="text-sm text-[var(--color-text)]">{{answer.username}}</p>
						</div>
					</div>
				{% endfor %}

				{% if not question.answers %}
					<h2 class="text-center text-lg w-full font-bold">No Answers</h2>
				{% endif %}


			</div>
			{% if app.user %}
				<!-- Add Answer -->
				<div class="mt-6 bg-[var(--color-card-bg)] border border-[var(--color-border)] rounded-xl shadow-md p-6">
					<h3 class="text-lg font-semibold text-[var(--color-text)] mb-4">Your Answer</h3>
					<textarea class="w-full h-32 rounded-lg border border-[var(--color-border)] bg-[var(--color-bg)] text-[var(--color-text)] p-3 mb-4 focus:ring-2 focus:ring-[var(--color-primary)]" placeholder="Write your answer here..."></textarea>
					<button class="px-6 py-2 rounded-lg bg-[var(--color-primary)] text-white hover:bg-[var(--color-accent)]">
						Post Your Answer
					</button>
				</div>

			{% endif %}

		</div>
	</section>


{% endblock %}


{% block scripts %}

	<script src="{{asset('js/questionActions.js')}}"></script>

{% endblock %}
